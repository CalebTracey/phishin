<div id="header_container">
  <div id="header">
    <%= content_tag :h1, "Song: #{@song.title}" %>
    <%= content_tag :h3, pluralize(@song.tracks.size, 'track') %>
    <% #render partial: 'header_filter', locals: { current_title: 'Sort Chronologically', item_hash: {'Sort Chronologically' => '?sort=show_date', 'Sort by Likes' => '?sort=likes'} } %>
  </div>
</div>
  
<div id="content">
  
    <% last_title = false %>
    <% @tracks.each_with_index do |track, idx| %>
    
      <% if track.show %>

        <% title = track.show.date.strftime("%Y") %>
        <% if title != last_title %>
          <% if last_title %>
            </ul>
          <% end %>
          <% last_title = title %>
          <%= content_tag 'h1', title %>
          <ul class="item_list clickable">
        <% end %>

      <li>
        <%= content_tag :h2, link_to(track.show.date.strftime("%b %-d"), "/#{track.show.date}/#{track.songs.first.slug}") %>
        <%= content_tag :h4, link_to(truncate(track.show.venue.name.html_safe, length: 36), "/#{track.show.venue.slug}") %>
        <%= content_tag :h5, link_to(track.show.venue.location, "/map") %>
        <%= render partial: 'shared/context_menu_for_track', locals: { track: track, playlist: false, show: nil } %>
        <%= likable(track, @tracks_likes[idx], 'small') %>
        <%= content_tag :h3, track.duration_readable %>
        <div style="clear: both;"></div>
      </li>
      
    <% end %>

  <% end %>
  
  </ul>

</div>
