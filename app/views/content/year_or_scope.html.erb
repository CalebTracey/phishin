<%= render partial: 'layouts/global_nav' %>

<div id="content">
  
  <div id="title_box">
    <%= content_tag :h1, @title %>
    <%= content_tag :div, nil, class: 'hr' %>
    <%= content_tag :h2, "Shows: #{@shows.size}" %>
    <%= content_tag :div, nil, class: 'hr' %>
    <%= render partial: 'sort_filter', locals: { item_hash: {'<i class="icon-time"></i> Reverse Date' => 'date desc', '<i class="icon-time"></i> Date' => 'date asc', '<i class="icon-heart"></i> Likes' => 'likes',  '<i class="icon-play-circle"></i> Duration' => 'duration'} } %>
    <%# if @viewing_single_year %>
      <%# content_tag :div, nil, class: 'hr' %>
      <%# link_to('<i class="icon-chevron-left"></i>&nbsp;&nbsp;Previous Year'.html_safe, "/#{@title.to_i - 1}") %>
      <!-- <div style="clear: both;"></div> -->
      <%# link_to('<i class="icon-chevron-right"></i>&nbsp;&nbsp;Next Year'.html_safe, "/#{@title.to_i + 1}") %>
    <%# end %>
  </div>
  
  <div id="content_box">
    <% if @shows.empty? %>
      <h2>Got a blank space where shows should be...</h2>
    <% else %>
  
      <% unless @display_separators %>
        <ul class="item_list clickable">
      <% end %>
  
      <% tour = false %>
      <% @shows.each_with_index do |show, idx| %>
  
        <% if @display_separators %>
          <% if show.tour != tour %>
            <% if tour %>
              </ul>
            <% end %>
            <%= content_tag 'h1', show.tour.name %>
            <ul class="item_list clickable">
            <% tour = show.tour %>
          <% end %>
        <% end %>
    
        <li>
          <%= content_tag :h2, link_to_show(show, @display_separators) %>
          <%= content_tag :h4, link_to(truncate(show.venue.name, length: 50), "/#{show.venue.slug}"), class: 'wide' %>
          <%# content_tag :h5, link_to(show.venue.location, "/map?map_term=#{CGI::escape(show.venue.location)}") %>
          <% #content_tag :span, "#{show.duration_readable}", class: 'show_duration_small' %>
          <%= likable(show, @shows_likes[idx], 'small') %>
          <%= content_tag :h3, duration_readable(show.duration, 'letters') %>
          <%= render partial: 'shared/context_menu_for_show', locals: { show: show, viewing_this_show: false } %>
          <span class="show_tag_container">
            <% show.tags.each do |tag| %>
              <%= content_tag :span, tag.name, class: 'label show_tag', style: "background-color: #{tag.color}" %>
            <% end %>
          </span>
          <div style="clear: both;"></div>
        </li>
      
      <% end %>
      </ul>
    <% end %>
  </div>
  
  <div style="clear: both;"></div>

</div>
