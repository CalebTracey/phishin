<div id="header_container">
  <div id="header">
    <%= content_tag :h1, linked_show_date(@show) %>
    <% unless @show.missing? %>
      <%= content_tag :h2, (link_to truncate(@show.venue.name.html_safe, length: 40), "/#{@show.venue.slug}", alt: @show.venue.name) %>
      <%= content_tag :h2, (link_to @show.venue.location, "/map?term=#{CGI::escape(@show.venue.location)}", alt: @show.venue.location) %>
      <%= render partial: 'shared/context_menu_for_show', locals: {show: @show, viewing_this_show: true, next_show: @next_show, previous_show: @previous_show } %>
      <%= likable(@show, @show_like, 'large') %>
    <% end %>
  </div>
</div>
  
<div id="content">
  
  <% if @show.missing? %>
    <div class="incomplete_show">Sorry, this show is missing</div>
  <% else %>
  
    <% if @show.incomplete? %>
      <div class="incomplete_show">This show is incomplete</div>
    <% end %>
  
    <% set = false %>
    <% @tracks.each_with_index do |track, idx| %>
    
      <% if track.set != set %>
        <% if set %>
          </ul>
        <% end %>
        <%= content_tag 'h1', track.set_name %>
        <ul class="item_list">
        <% set = track.set %>
      <% end %>
    
      <li class="playable_track" data-id="<%= track.id %>" data-anchor="<%= track.slug %>">
        <%= content_tag :h2, truncate(track.title, length: 45), class: 'wider' %>
        <%= render partial: 'shared/context_menu_for_track', locals: { track: track, show: @show, playlist: false } %>
        <%= content_tag :h3, track.duration_readable %>
        <%= likable(track, @tracks_likes[idx], 'small') %>
        <div style="clear: both;"></div>
      </li>
    <% end %>
    </ul>
  
  <% end %>
  
</div>